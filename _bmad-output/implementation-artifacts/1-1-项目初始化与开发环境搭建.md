# Story 1.1: 项目初始化与开发环境搭建

Status: done

## Story

As a 开发者,
I want 使用 Vite + React + TypeScript 初始化前端项目，使用 FastAPI + LangGraph 初始化后端项目，并建立完整目录结构,
so that 拥有可运行的项目骨架，所有后续开发有统一的基础。

## Acceptance Criteria

1. **Given** 项目根目录 **When** 执行前端初始化命令 `npm create vite@latest frontend -- --template react-ts` 并安装 antd、react-router-dom **Then** 前端开发服务器可在 localhost:5173 正常启动并显示默认页面

2. **Given** 前端项目已初始化 **When** 查看 package.json **Then** 包含 react、react-dom、antd、react-router-dom 依赖

3. **Given** 项目根目录 **When** 执行后端初始化 `mkdir backend && cd backend && pipenv install fastapi "uvicorn[standard]" langgraph langchain-google-genai` **Then** 后端 Pipfile 中包含所有指定依赖

4. **Given** 后端依赖已安装 **When** 创建 app/main.py 入口并启动 uvicorn **Then** 后端服务可在 localhost:8000 正常启动，访问 /docs 可看到 FastAPI 自动文档

5. **Given** 前后端均可启动 **When** 查看项目目录结构 **Then** 前端 src/ 下包含 components/、views/、hooks/、services/、types/、context/ 目录；后端 app/ 下包含 routers/、schemas/、agent/（含 skills/、tools/）、mock/、store/ 目录

6. **Given** 后端项目 **When** 查看 .env.example **Then** 包含 GOOGLE_API_KEY 环境变量模板

## Tasks / Subtasks

- [x] Task 1: 初始化前端项目 (AC: #1, #2)
  - [x] 1.1 在项目根目录执行 `npm create vite@latest frontend -- --template react-ts`
  - [x] 1.2 进入 frontend 目录执行 `npm install antd react-router-dom`
  - [x] 1.3 验证 `npm run dev` 可在 localhost:5173 正常启动
  - [x] 1.4 验证 package.json 包含 react、react-dom、antd、react-router-dom

- [x] Task 2: 创建前端目录结构 (AC: #5)
  - [x] 2.1 创建 `src/components/ActionLogItem/` 目录
  - [x] 2.2 创建 `src/components/ChatBubble/` 目录
  - [x] 2.3 创建 `src/components/ChannelTab/` 目录
  - [x] 2.4 创建 `src/views/DemoView/` 目录
  - [x] 2.5 创建 `src/views/AdminView/` 目录
  - [x] 2.6 创建 `src/views/HistoryView/` 目录
  - [x] 2.7 创建 `src/hooks/` 目录
  - [x] 2.8 创建 `src/services/` 目录
  - [x] 2.9 创建 `src/types/` 目录
  - [x] 2.10 创建 `src/context/` 目录
  - [x] 2.11 创建各目录下的占位文件（`.gitkeep` 或初始空文件）

- [x] Task 3: 设置前端骨架代码 (AC: #1)
  - [x] 3.1 配置 `src/App.tsx` — React Router 三路由骨架（`/`、`/admin`、`/history`）
  - [x] 3.2 配置 `src/main.tsx` — Ant Design ConfigProvider 包裹（主色 #1677FF）
  - [x] 3.3 创建 `src/types/index.ts` — 空文件占位
  - [x] 3.4 创建 `src/services/api.ts` — 空文件占位（`const API_BASE = 'http://localhost:8000/api'`）
  - [x] 3.5 创建 `src/context/AppContext.tsx` — 空文件占位
  - [x] 3.6 创建三个视图组件占位文件（DemoView.tsx、AdminView.tsx、HistoryView.tsx）
  - [x] 3.7 清理 Vite 默认生成的多余文件（App.css 内容清空、删除 assets/react.svg 等）

- [x] Task 4: 初始化后端项目 (AC: #3, #4)
  - [x] 4.1 在项目根目录创建 `backend/` 目录
  - [x] 4.2 进入 backend 目录执行 `pipenv install fastapi "uvicorn[standard]" langgraph langchain-google-genai`
  - [x] 4.3 创建 `app/__init__.py`
  - [x] 4.4 创建 `app/main.py` 包含 FastAPI 实例和 CORS 配置
  - [x] 4.5 验证 `pipenv run uvicorn app.main:app --reload` 可在 localhost:8000 正常启动
  - [x] 4.6 验证访问 localhost:8000/docs 可看到 Swagger 文档

- [x] Task 5: 创建后端目录结构 (AC: #5)
  - [x] 5.1 创建 `app/routers/__init__.py`
  - [x] 5.2 创建 `app/schemas/__init__.py`
  - [x] 5.3 创建 `app/agent/__init__.py`
  - [x] 5.4 创建 `app/agent/skills/__init__.py`
  - [x] 5.5 创建 `app/agent/tools/__init__.py`
  - [x] 5.6 创建 `app/mock/__init__.py`
  - [x] 5.7 创建 `app/store/__init__.py`
  - [x] 5.8 创建 `tests/__init__.py`

- [x] Task 6: 环境配置 (AC: #6)
  - [x] 6.1 创建 `backend/.env.example` 包含 `GOOGLE_API_KEY=your_api_key_here`
  - [x] 6.2 创建 `backend/.env` 从 .env.example 复制（加入 .gitignore）
  - [x] 6.3 确保 `.gitignore` 包含必要条目

## Dev Notes

### 技术栈版本（已验证 2026-02-26）

| 库 | 指定版本 | 最新可用 | 说明 |
|---|---|---|---|
| Vite | 最新 | 7.3.1 | react-ts 模板 |
| antd | v6 | 6.3.1 | CSS-in-JS + CSS Variables 模式 |
| react-router-dom | 最新 | 7.13.1 | ⚠️ v7 API，见下方注意事项 |
| FastAPI | 0.133.1 | 0.133.1 | 最新稳定版 |
| LangGraph | 1.0.7 | 1.0.9 | 按架构文档使用 1.0.7 |
| langchain-google-genai | 4.0.0 | 4.2.1 | 按架构文档使用 4.0.0 |
| Python | 3.12+ | — | pipenv 管理虚拟环境 |
| TypeScript | 5.x | — | Vite 模板自带 |

### react-router-dom v7 关键注意事项

react-router-dom v7 与 v6 有显著 API 变化（合并了 Remix）。本项目路由极简（3 个静态路由），使用以下模式：

```tsx
// App.tsx — 使用 BrowserRouter + Routes + Route（v7 仍支持）
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<DemoView />} />
        <Route path="/admin" element={<AdminView />} />
        <Route path="/history" element={<HistoryView />} />
      </Routes>
    </BrowserRouter>
  );
}
```

**禁止**使用 v7 的 data router API（`createBrowserRouter`、`loader`、`action`），本项目不需要这些功能，保持简单。

### Ant Design v6 ConfigProvider 配置

```tsx
// main.tsx
import { ConfigProvider } from 'antd';
import zhCN from 'antd/locale/zh_CN';

<ConfigProvider
  locale={zhCN}
  theme={{ token: { colorPrimary: '#1677FF' } }}
>
  <App />
</ConfigProvider>
```

### FastAPI main.py 骨架（含 CORS）

```python
# app/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI(title="AI Agent Demo", version="0.1.0")

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:5173"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

@app.get("/api/health")
async def health_check():
    return {"status": "ok"}
```

### 命名规范（全项目统一）

| 场景 | 规则 | 示例 |
|---|---|---|
| Python 变量/函数 | snake_case | `get_order_info` |
| Python 类名 | PascalCase | `AgentExecutionState` |
| Python 文件 | snake_case | `agent_engine.py` |
| TypeScript 变量/函数 | camelCase | `getOrderInfo` |
| TypeScript 类型 | PascalCase | `ActionLogEntry` |
| React 组件文件 | PascalCase.tsx | `ActionLogItem.tsx` |
| 非组件 TS 文件 | camelCase.ts | `usePolling.ts` |
| API 端点 | kebab-case 名词 | `/api/skills` |
| JSON 字段 | snake_case | `session_id` |

### 完整目标目录结构

```
AI_coding_demo/
├── frontend/
│   ├── package.json
│   ├── tsconfig.json
│   ├── tsconfig.app.json
│   ├── tsconfig.node.json
│   ├── vite.config.ts
│   ├── index.html
│   ├── .gitignore
│   ├── public/
│   └── src/
│       ├── main.tsx                   # 入口 + ConfigProvider
│       ├── App.tsx                    # 根组件 + React Router
│       ├── App.css                    # 全局样式（最小化）
│       ├── types/
│       │   └── index.ts              # 空占位
│       ├── services/
│       │   └── api.ts                # API_BASE 常量占位
│       ├── hooks/
│       │   └── .gitkeep
│       ├── context/
│       │   └── AppContext.tsx         # 空占位
│       ├── components/
│       │   ├── ActionLogItem/
│       │   │   └── .gitkeep
│       │   ├── ChatBubble/
│       │   │   └── .gitkeep
│       │   └── ChannelTab/
│       │       └── .gitkeep
│       └── views/
│           ├── DemoView/
│           │   └── DemoView.tsx       # 占位组件
│           ├── AdminView/
│           │   └── AdminView.tsx      # 占位组件
│           └── HistoryView/
│               └── HistoryView.tsx    # 占位组件
│
├── backend/
│   ├── Pipfile
│   ├── Pipfile.lock
│   ├── .env                          # 不提交 git
│   ├── .env.example                  # GOOGLE_API_KEY 模板
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                   # FastAPI 入口 + CORS
│   │   ├── routers/
│   │   │   └── __init__.py
│   │   ├── schemas/
│   │   │   └── __init__.py
│   │   ├── agent/
│   │   │   ├── __init__.py
│   │   │   ├── skills/
│   │   │   │   └── __init__.py
│   │   │   └── tools/
│   │   │       └── __init__.py
│   │   ├── mock/
│   │   │   └── __init__.py
│   │   └── store/
│   │       └── __init__.py
│   └── tests/
│       └── __init__.py
```

### 占位视图组件模式

每个视图组件使用统一占位模式：

```tsx
// DemoView.tsx
const DemoView = () => {
  return <div>演示视图 - 待实现</div>;
};
export default DemoView;
```

### .gitignore 关键条目

确保项目根 `.gitignore` 和各子项目 `.gitignore` 包含：
- `node_modules/`
- `.env`（仅 .env.example 提交）
- `__pycache__/`
- `*.pyc`
- `dist/`
- `.venv/`

### 架构边界提醒

本 Story 只做项目骨架搭建，**禁止**：
- 实现任何业务逻辑
- 创建 Pydantic 模型（Story 1.2 负责）
- 实现任何 API 端点路由逻辑（Story 1.5 负责）
- 添加任何组件实际功能

**只做**：
- 初始化项目和安装依赖
- 创建目录结构和空文件
- 设置 CORS 和健康检查端点
- 配置路由骨架和 ConfigProvider

### Project Structure Notes

- 前端和后端是两个独立的子项目，分别有自己的包管理
- 前端使用 npm，后端使用 pipenv
- 前端 Vite 默认端口 5173，后端 uvicorn 默认端口 8000
- CORS 配置仅允许 localhost:5173 访问

### References

- [Source: _bmad-output/planning-artifacts/architecture.md#Starter Template Evaluation] — 初始化命令和技术栈选型
- [Source: _bmad-output/planning-artifacts/architecture.md#Complete Project Directory Structure] — 完整目录结构定义
- [Source: _bmad-output/planning-artifacts/architecture.md#Implementation Patterns & Consistency Rules] — 命名规范和反模式
- [Source: _bmad-output/planning-artifacts/architecture.md#API & Communication Patterns] — CORS 配置
- [Source: _bmad-output/planning-artifacts/architecture.md#Frontend Architecture] — 前端组件组织和路由
- [Source: _bmad-output/planning-artifacts/ux-design-specification.md#Design System Foundation] — Ant Design 组件和配色策略
- [Source: _bmad-output/planning-artifacts/epics.md#Story 1.1] — 验收标准

## Dev Agent Record

### Agent Model Used

Claude Opus 4.6 (claude-opus-4-6)

### Debug Log References

无异常，所有步骤一次通过。

### Completion Notes List

- Task 1: 使用 Vite 7.3.1 + react-ts 模板初始化前端项目，安装 antd ^6.3.1 和 react-router-dom ^7.13.1，dev server 在 localhost:5173 成功启动并返回 HTTP 200
- Task 2: 创建前端完整目录结构（components/ActionLogItem、ChatBubble、ChannelTab，views/DemoView、AdminView、HistoryView，hooks、services、types、context），空目录添加 .gitkeep
- Task 3: 配置 App.tsx（BrowserRouter + 3 路由），main.tsx（ConfigProvider + zhCN locale + #1677FF 主色），创建占位文件（types/index.ts、services/api.ts、context/AppContext.tsx、三个视图组件），清理 Vite 默认文件
- Task 4: 创建 backend/ 目录，通过 pipenv 安装 fastapi、uvicorn[standard]、langgraph、langchain-google-genai，创建 app/main.py（FastAPI + CORS），uvicorn 在 localhost:8000 成功启动，/docs 和 /api/health 均返回 200
- Task 5: 创建后端完整目录结构（routers、schemas、agent/skills、agent/tools、mock、store、tests），每个目录含 __init__.py
- Task 6: 创建 .env.example（GOOGLE_API_KEY 模板）和 .env，更新根 .gitignore 添加 node_modules/ 和 .DS_Store 条目

### File List

**新增文件:**
- frontend/package.json
- frontend/tsconfig.json
- frontend/tsconfig.app.json
- frontend/tsconfig.node.json
- frontend/vite.config.ts
- frontend/index.html
- frontend/eslint.config.js
- frontend/.gitignore
- frontend/src/main.tsx
- frontend/src/App.tsx
- frontend/src/index.css
- frontend/src/vite-env.d.ts
- frontend/src/types/index.ts
- frontend/src/services/api.ts
- frontend/src/context/AppContext.tsx
- frontend/src/views/DemoView/DemoView.tsx
- frontend/src/views/AdminView/AdminView.tsx
- frontend/src/views/HistoryView/HistoryView.tsx
- frontend/src/components/ActionLogItem/.gitkeep
- frontend/src/components/ChatBubble/.gitkeep
- frontend/src/components/ChannelTab/.gitkeep
- frontend/src/hooks/.gitkeep
- backend/Pipfile
- backend/Pipfile.lock
- backend/.env.example
- backend/app/__init__.py
- backend/app/main.py
- backend/app/routers/__init__.py
- backend/app/schemas/__init__.py
- backend/app/agent/__init__.py
- backend/app/agent/skills/__init__.py
- backend/app/agent/tools/__init__.py
- backend/app/mock/__init__.py
- backend/app/store/__init__.py
- backend/tests/__init__.py

**修改文件:**
- .gitignore（添加 node_modules/ 和 .DS_Store）

**删除文件:**
- frontend/src/assets/react.svg
- frontend/src/App.css（代码审查：清理空死文件）
- frontend/public/vite.svg（代码审查：清理 Vite 默认品牌图标）
- frontend/src/assets/（代码审查：删除空目录）

## Change Log

- 2026-02-26: 完成 Story 1.1 全部 6 个 Task — 项目初始化与开发环境搭建。前端 Vite + React + TypeScript + Ant Design + React Router 骨架就绪，后端 FastAPI + LangGraph + langchain-google-genai 骨架就绪，完整目录结构已创建，环境配置完成。
- 2026-02-26: 代码审查修复 — 锁定 Pipfile 版本（langgraph==1.0.7, langchain-google-genai==4.0.0, fastapi==0.133.1）；清理 index.css Vite 默认深色主题样式；更新 index.html（lang=zh-CN, title=AI Agent Demo, 移除 vite.svg favicon）；删除 Vite 残留文件（public/vite.svg、空 App.css、空 assets/ 目录）；更新 File List 移除 backend/.env。
